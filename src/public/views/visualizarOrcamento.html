<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <title>Visualizar Orçamento</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../css/global.css" />
    <link rel="stylesheet" href="../css/visualizarOrcamento.css" />
  </head>

  <body>
    <div
      class="d-flex justify-content-center align-items-center"
      style="min-height: 90vh"
    >
      <div class="card-visualizar">
        <h2>Orçamento Gerado</h2>
        <div id="orcamento-dados" class="mb-4"></div>
        <div class="mb-3 d-flex flex-wrap gap-2 justify-content-center">
          <button id="btnExcluir" class="btn btn-escuro btn-elevate">
            Excluir Orçamento
          </button>
          <button id="btnEnviar" class="btn btn-preto btn-elevate">
            Enviar Orçamento
          </button>
          <a href="home.html" class="btn btn-claro btn-elevate"
            >Voltar para Home</a
          >
        </div>
      </div>
    </div>
    <script>
      // Função para obter o ID da URL
      function getQueryParam(param) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param);
      }

      const orcamentoId = getQueryParam('id');
      const orcamentoType = getQueryParam('type');
      const container = document.getElementById('orcamento-dados');

      if (orcamentoId && orcamentoType) {
        // Busca o orçamento do banco de dados via API
        fetch(`/api/${orcamentoType}s/${orcamentoId}`)
          .then((response) => {
            if (!response.ok) {
              throw new Error('Orçamento não encontrado.');
            }
            return response.json();
          })
          .then((dados) => {
            container.innerHTML = `<pre>${JSON.stringify(dados, null, 2)}</pre>`;
          })
          .catch((error) => {
            console.error('Erro:', error);
            container.innerHTML = `<p>${error.message}</p>`;
          });
      } else {
        container.innerHTML = '<p>Nenhum orçamento encontrado.</p>';
      }

      // Funções para os botões (sem a lógica de localStorage)
      document.getElementById('btnExcluir').onclick = () => {
        if (confirm('Deseja excluir este orçamento?')) {
          // A lógica de exclusão no banco de dados seria adicionada aqui
          console.log('Função de exclusão em desenvolvimento!');
        }
      };

      document.getElementById('btnEnviar').onclick = () => {
        // A lógica de envio do orçamento seria adicionada aqui
        console.log('Função de envio em desenvolvimento!');
      };
    </script>
  </body>
</html>